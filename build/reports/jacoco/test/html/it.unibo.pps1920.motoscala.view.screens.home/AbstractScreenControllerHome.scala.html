<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>AbstractScreenControllerHome.scala</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">pps-19-motoScala</a> &gt; <a href="index.source.html" class="el_package">it.unibo.pps1920.motoscala.view.screens.home</a> &gt; <span class="el_source">AbstractScreenControllerHome.scala</span></div><h1>AbstractScreenControllerHome.scala</h1><pre class="source lang-java linenums">package it.unibo.pps1920.motoscala.view.screens.home

import it.unibo.pps1920.motoscala.controller.ObservableUI
import it.unibo.pps1920.motoscala.view.ViewFacade
import it.unibo.pps1920.motoscala.view.fsm.ChangeScreenEvent
import it.unibo.pps1920.motoscala.view.screens.ScreenController
import it.unibo.pps1920.motoscala.view.utilities.ViewConstants
import it.unibo.pps1920.motoscala.view.utilities.ViewUtils.addButtonMusic
import javafx.fxml.FXML
import javafx.scene.control.Button
import javafx.scene.image.ImageView
import javafx.scene.layout.{AnchorPane, BorderPane, GridPane, Pane}
import javafx.scene.shape.Line
import javafx.scene.{CacheHint, Node}
import scalafx.animation.{Timeline, TranslateTransition}
import scalafx.scene.shape.Rectangle
import scalafx.util.Duration

/** Abstract ScreenController dedicated to show main menu.
 *
 * @param viewFacade the view facade
 * @param controller the controller
 */
<span class="nc" id="L24">protected[home] abstract class AbstractScreenControllerHome(</span>
<span class="nc" id="L25">  protected override val viewFacade: ViewFacade,</span>
<span class="nc" id="L26">  protected override val controller: ObservableUI) extends ScreenController(viewFacade, controller) {</span>

<span class="nc" id="L28">  @FXML protected final var root: BorderPane = _</span>
<span class="nc" id="L29">  @FXML protected final var mainAnchorPane: AnchorPane = _</span>
<span class="nc" id="L30">  @FXML protected final var mainGridPane: GridPane = _</span>
<span class="nc" id="L31">  @FXML protected final var title: ImageView = _</span>
<span class="nc" id="L32">  @FXML protected final var textPlay: Button = _</span>
<span class="nc" id="L33">  @FXML protected final var textPlayMultiplayer: Button = _</span>
<span class="nc" id="L34">  @FXML protected final var textSettings: Button = _</span>
<span class="nc" id="L35">  @FXML protected final var textStats: Button = _</span>
<span class="nc" id="L36">  @FXML protected final var textExit: Button = _</span>

  @FXML override def initialize(): Unit = {
<span class="nc" id="L39">    assertNodeInjected(root, mainAnchorPane, mainGridPane, title, textPlay, textPlayMultiplayer, textSettings, textStats, textExit)</span>
<span class="nc" id="L40">    initializeGrid(root)</span>
<span class="nc" id="L41">    initializeBackground(root)</span>
<span class="nc" id="L42">    initializeButtons()</span>
  }


  private def initializeButtons(): Unit = {

<span class="nc" id="L48">    addButtonMusic(textPlay, textPlayMultiplayer, textSettings, textStats, textExit)(controller)</span>

<span class="nc" id="L50">    textPlay.setOnAction(_ =&gt; viewFacade.changeScreen(ChangeScreenEvent.GotoLevels))</span>
<span class="nc" id="L51">    textPlayMultiplayer.setOnAction(_ =&gt; viewFacade.changeScreen(ChangeScreenEvent.GotoSelection))</span>
<span class="nc" id="L52">    textSettings.setOnAction(_ =&gt; viewFacade.changeScreen(ChangeScreenEvent.GotoSettings))</span>
<span class="nc" id="L53">    textStats.setOnAction(_ =&gt; viewFacade.changeScreen(ChangeScreenEvent.GotoStats))</span>
<span class="nc" id="L54">    textExit.setOnAction(_ =&gt; System.exit(0))</span>
  }

  private def initializeBackground(pane: Pane): Unit = {
    //Background setup
<span class="nc" id="L59">    val background: Rectangle = new Rectangle()</span>
<span class="nc" id="L60">    background.width = ViewConstants.Window.ScreenWidth</span>
<span class="nc" id="L61">    background.height = ViewConstants.Window.ScreenHeight</span>
<span class="nc" id="L62">    setCache(background)</span>
<span class="nc" id="L63">    background.setId(MagicValues.CSSBackgroundID)</span>
<span class="nc" id="L64">    pane.getChildren.add(0, background)</span>
  }

  def setCache(node: Node): Unit = {
<span class="nc" id="L68">    node.setCache(true)</span>
<span class="nc" id="L69">    node.setCacheHint(CacheHint.SPEED)</span>
  }

  private def initializeGrid(pane: Pane): Unit = {

    def addAnimation(node: Line, mul: Int): Unit = {
<span class="nc" id="L75">      val translate: TranslateTransition = new TranslateTransition</span>
<span class="nc" id="L76">      translate.setDuration(Duration.apply(MagicValues.AnimationDuration * 2))</span>
<span class="nc" id="L77">      translate.setToY((ViewConstants.Window.ScreenHeight + MagicValues.YLinePortion * mul) / 2)</span>
<span class="nc" id="L78">      translate.setCycleCount(Timeline.Indefinite)</span>
<span class="nc" id="L79">      translate.setNode(node)</span>
<span class="nc" id="L80">      translate.setAutoReverse(true)</span>
<span class="nc" id="L81">      translate.play()</span>
    }
    //Vertical line setup
<span class="nc" id="L84">    MagicValues.LineNumberX.leftBound to MagicValues.LineNumberX.rightBound foreach (multiplier =&gt; {</span>
<span class="nc" id="L85">      val xLine = new Line(0, MagicValues.XlinePortion * multiplier, MagicValues.PixelLineLength, MagicValues</span>
<span class="nc" id="L86">        .XlinePortion * multiplier)</span>
<span class="nc" id="L87">      xLine.setId(MagicValues.CSSLineID)</span>
<span class="nc" id="L88">      setCache(xLine)</span>
<span class="nc" id="L89">      addAnimation(xLine, multiplier)</span>
<span class="nc" id="L90">      root.getChildren.add(0, xLine)</span>
    })

    //Horizontal line setup
<span class="nc" id="L94">    MagicValues.LineNumberY.leftBound to MagicValues.LineNumberY.rightBound foreach (multiplier =&gt; {</span>
<span class="nc" id="L95">      val yLine = new Line(MagicValues.YLinePortion * multiplier, -MagicValues.PixelLineLength, MagicValues</span>
<span class="nc" id="L96">        .YLinePortion * multiplier, MagicValues.PixelLineLength)</span>
<span class="nc" id="L97">      yLine.setId(MagicValues.CSSLineID)</span>
<span class="nc" id="L98">      setCache(yLine)</span>
<span class="nc" id="L99">      pane.getChildren.add(0, yLine)</span>
    })
  }
<span class="nc" id="L102">  override def whenDisplayed(): Unit = {}</span>
<span class="nc bnc" id="L103" title="All 4 branches missed.">  private[this] final object MagicValues {</span>
    final val AnimationDuration = 5000
    final val PixelLineLength = 5000
    final val ScreenLineDivider = 10
<span class="nc" id="L107">    final val XlinePortion = ViewConstants.Window.ScreenHeight / ScreenLineDivider</span>
<span class="nc" id="L108">    final val YLinePortion = ViewConstants.Window.ScreenWidth / ScreenLineDivider</span>
    final val CSSLineID = &quot;Line&quot;
    final val CSSBackgroundID = &quot;Background&quot;
    sealed trait LineNumber {
      def leftBound: Int
      def rightBound: Int
    }
<span class="nc bnc" id="L115" title="All 4 branches missed.">    case object LineNumberX extends LineNumber {</span>
<span class="nc" id="L116">      val leftBound: Int = -2</span>
<span class="nc" id="L117">      val rightBound: Int = 10</span>
    }

<span class="nc bnc" id="L120" title="All 4 branches missed.">    case object LineNumberY extends LineNumber {</span>
<span class="nc" id="L121">      val leftBound: Int = 1</span>
<span class="nc" id="L122">      val rightBound: Int = 10</span>
    }

  }
<span class="nc" id="L126">}</span>
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.6.202009150832</span></div></body></html>